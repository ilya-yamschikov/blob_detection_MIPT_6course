\documentclass[11pt]{article}
\usepackage{amsmath, amsfonts, amssymb}
\usepackage[english, russian]{babel}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{color}
\usepackage{indentfirst}
\usepackage[noend]{algorithmic}

\usepackage{geometry}
\geometry{left=2cm}
\geometry{right=1.5cm}
\geometry{top=1cm}
\geometry{bottom=2cm}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

% Commands to avoid mixing of assigned letters
\newcommand{\xs}{m} % image size on X axis
\newcommand{\ys}{n} % image size on Y axis
\newcommand{\rc}{k} % count of radiuses to search

\def\algorithmicrequire{\textbf{Вход:}}
\def\algorithmicensure{\textbf{Выход:}}
\def\algorithmicif{\textbf{если}}
\def\algorithmicthen{\textbf{то}}
\def\algorithmicforall{\textbf{для всех}}
\def\algorithmicdo{}

\begin{document}

\section*{ Поиск светлых пятен}

\section{Задача:}Рассматриваем задачу обработки изображений. Требуется на монохромном изображении выделить светлые пятна - однородные яркие участки с резким изменением градиента яркости на границе. Ключевые слова для подобных алгоритмов - \textit{blob detection}.

В данной задаче под изображением понимаем матрицу $Z = \{z_{ij}\}, i=1,\dots,\xs, j=1,\dots,\ys$ где $z_{ij} \in B$ - яркость пиксела.
Здесь $B \in \mathbb{R}_+$ - возможные значения яркости. В компьютерной графике обычно $B = \{1,\dots,256\}$.

\section{Интерфейс:} таким образом на вход алгоритм получает изображение $Z$, а на выход выдает множество эллипсов $\{\varepsilon_1,\dots,\varepsilon_k\}$ - светлых пятен изображения.

\section{Алгоритм:}
\subsection{Описание:}
Алгоритм должен получать на вход изображение $Z$ и, возможно, набор параметров. На выходе требуется получить бинарную матрицу $R$ в которой единицам соответствуют центры найденных пятен.
\begin{figure}[h]
\caption{Пример работы алгоритма.}
\end{figure}

Для нахождения светлых пятен воспользуемся одним из самых известных алгоритмов в данной области LoG-детектор \cite{MarrHildreth80} (Laplacian-of-Gaussian).В этом алгоритме производится свертка изображения со второй производной гауссианы и затем на получившемся изображении ищутся локальные минимумы. Они будут соответствовать светлым пятнам на изображении.

\subsection{Алгоритм:}
\textbf{Обозначения:}
\begin{itemize}
    \item $Z$ - входное изображение
    \item $R$ - матрица, совпадающая по размеру с $Z$, с элементами $r_{ij} \in \{0,1\}$, в которой единицы соответствуют центрам ярких пятен.
    \item $\mathbf{r} = (r_1, r_2, \ldots, r_{\rc})$ - набор возможных радиусов ярких пятен среди которых ведется поиск
    \item $G(x, y, \sigma)$ - гауссиана с центром в $(x, y)$ и параметром $\sigma$.
    \item $\hat{G}(x, y, \sigma)$ - нормированная гауссиана: $\hat{G}(x, y, \sigma) = \sigma^2 G(x, y, \sigma)$
    \item $\nabla \hat{G}(x, y, \sigma)$ - вторая производная нормированной гауссианы
    \item $Convolution(img_1, img_2)$ - функция свертки изображений $img_1$ и $img_2$
    \item $\mathbf{Conv} = (conv_1, \ldots, conv_{\rc})$ - множество сверток.
\end{itemize}

\begin{algorithmic}[1]
\REQUIRE $Z$, $\mathbf{r}$
\ENSURE $R$
\STATE $R \leftarrow 0^{\xs \times \ys}$
\STATE \textit{// Создаем набор сверток с различными масками}
\FORALL{$r_{k}$ в $\mathbf{r}$}
    \STATE $conv_k \leftarrow Convolution(Z, \nabla\hat{G}(x, y, r_k))$
\ENDFOR
\STATE \textit{// Ищем центры ярких пятен}
\FORALL {$(i,j)$ в $[1,\ldots,\xs]\times[1,\ldots,\ys]$}
    \STATE $k_{min conv} \leftarrow \argmin\limits_{k} conv_k(i,j)$
    \IF {$(i,j)$ - точка локального минимума в $conv_{k_{min conv}}$}
        \STATE $R_{ij} \leftarrow 1$
    \ENDIF
\ENDFOR
\end{algorithmic}

\section{Тестовые данные:} Для начальной проверки алгоритма (и юнит-тестов) предлагается сгенерировать ряд тестовых изображений. На черный фон добавляются несколько гауссовых пиков и полученное изображение зашумляется (опционально).

\begin{thebibliography}{9}
\bibitem{MarrHildreth80} D. Marr and E.C. Hildreth. Theory of edge detection. Proc. Roy. Soc. London., B-207:187--217, 1980.
\bibitem{MS04} Krystian Mikolajczyk and Cordelia Schmid, Scale and affine invariant interest point detectors,
\emph{International Journal of Computer Vision}, pp. 63--86, 2004
\end{thebibliography}
\end{document} 